<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>DePINfinity Demo - Hackathon Edition</title>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <div class="container">
            <!-- Header -->
            <header class="header">
                <h1 class="title">DePINfinity</h1>
                <p class="subtitle">Decentralized Mobile Infrastructure</p>
                <div class="status-indicator" id="statusIndicator">
                    <span id="statusText">Disconnected</span>
                </div>
            </header>

            <!-- Demo Controls -->
            <section class="section">
                <h2 class="section-title">Demo Controls</h2>
                <div class="button-row">
                    <button id="startDemoBtn" class="button button-primary">
                        Start Demo
                    </button>
                    <button id="stopDemoBtn" class="button button-secondary">
                        Stop Demo
                    </button>
                </div>
            </section>

            <!-- Device Registration -->
            <section class="section">
                <h2 class="section-title">Device Registration</h2>
                <button id="registerDeviceBtn" class="button">
                    Register Device
                </button>
            </section>

            <!-- B2B Network Stats -->
            <section class="section" id="b2bStatsSection" style="display: none">
                <h2 class="section-title">B2B Network Statistics</h2>
                <div class="stats-container">
                    <div class="stat-item">
                        <span class="stat-label">Data Points</span>
                        <span class="stat-value" id="dataPoints">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Active Agreements</span>
                        <span class="stat-value" id="activeAgreements">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Active Contracts</span>
                        <span class="stat-value" id="activeContracts">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Total Revenue</span>
                        <span class="stat-value" id="totalRevenue">$0.00</span>
                    </div>
                </div>
            </section>

            <!-- Device Stats -->
            <section
                class="section"
                id="deviceStatsSection"
                style="display: none"
            >
                <h2 class="section-title">Device Statistics</h2>
                <div class="stats-container">
                    <div class="stat-item">
                        <span class="stat-label">Total Uptime</span>
                        <span class="stat-value" id="totalUptime">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Total Rewards</span>
                        <span class="stat-value" id="totalRewards">0.00</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Status</span>
                        <span class="stat-value" id="deviceStatus"
                            >Inactive</span
                        >
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Last Activity</span>
                        <span class="stat-value" id="lastActivity">Never</span>
                    </div>
                </div>
            </section>

            <!-- Data Collection -->
            <section class="section">
                <h2 class="section-title">Data Collection</h2>
                <div class="control-row">
                    <span class="control-label">Auto Data Collection</span>
                    <label class="switch">
                        <input type="checkbox" id="dataCollectionToggle" />
                        <span class="slider"></span>
                    </label>
                </div>
                <button id="submitDataBtn" class="button">
                    Submit Data Now
                </button>
                <p class="info-text">
                    <small
                        >Note: This demo uses simulated location data. Real
                        location data is optional and will fallback to Tokyo
                        coordinates if not available.</small
                    >
                </p>
            </section>

            <!-- Network Data Display -->
            <section
                class="section"
                id="networkDataSection"
                style="display: none"
            >
                <h2 class="section-title">Network Quality Data</h2>
                <div class="data-container">
                    <div class="data-item">
                        <span class="data-label">Signal Strength</span>
                        <span class="data-value" id="signalStrength"
                            >-65 dBm</span
                        >
                    </div>
                    <div class="data-item">
                        <span class="data-label">Latency</span>
                        <span class="data-value" id="latency">45 ms</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Throughput</span>
                        <span class="data-value" id="throughput">1.2 Mbps</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Availability</span>
                        <span class="data-value" id="availability">95%</span>
                    </div>
                </div>
            </section>

            <!-- Demo Log -->
            <section class="section">
                <h2 class="section-title">Demo Log</h2>
                <div class="log-container" id="demoLog">
                    <div class="log-entry">
                        Demo ready. Click "Start Demo" to begin.
                    </div>
                </div>
            </section>
        </div>

        <script src="mock-solana.js"></script>
        <script src="mock-corda.js"></script>
        <script src="demo-simulator.js"></script>
        <script src="app.js"></script>

        <script>
            // Global error handler
            window.addEventListener("error", function (e) {
                console.error("Global error:", e.error);
            });

            // Check if all required classes are available
            window.addEventListener("load", function () {
                console.log("Page loaded, checking dependencies...");
                console.log(
                    "MockSolanaProgram available:",
                    typeof window.MockSolanaProgram
                );
                console.log(
                    "MockCordaNetwork available:",
                    typeof window.MockCordaNetwork
                );
                console.log(
                    "DemoSimulator available:",
                    typeof window.DemoSimulator
                );

                // Check if mock services are properly initialized
                if (typeof window.MockSolanaProgram === "function") {
                    console.log("MockSolanaProgram class is available");
                } else {
                    console.error("MockSolanaProgram class is NOT available");
                }

                if (typeof window.MockCordaNetwork === "function") {
                    console.log("MockCordaNetwork class is available");
                } else {
                    console.error("MockCordaNetwork class is NOT available");
                }
            });

            // Ensure mock services are available before app initialization
            window.addEventListener("DOMContentLoaded", function () {
                console.log("DOM Content Loaded - checking mock services...");

                // Wait a bit for all scripts to load
                setTimeout(() => {
                    if (typeof window.MockSolanaProgram === "function") {
                        window.mockSolanaProgram =
                            new window.MockSolanaProgram();
                        console.log("Mock Solana Program instance created");
                    }

                    if (typeof window.MockCordaNetwork === "function") {
                        window.mockCordaNetwork = new window.MockCordaNetwork();
                        console.log("Mock Corda Network instance created");
                    }
                }, 100);
            });
        </script>
    </body>
</html>
